function [x,y,z] = min_per_constr(beacons,dists)
% Finds good initial guess based on four distances

% beacons is (4 x 3) (rows are points and columns are coordinates)
% dists is (4 x 1) (rows are distances to points)

temp = (beacons(4,3)*beacons(3,1)*beacons(1,2)-beacons(1,1)*beacons(2,2)*beacons(3,3)-beacons(4,3)*beacons(3,1)*beacons(2,2)+beacons(4,3)*beacons(1,1)*beacons(2,2)-beacons(1,2)*beacons(3,1)*beacons(2,3)+beacons(1,3)*beacons(3,1)*beacons(2,2)+beacons(4,1)*beacons(2,3)*beacons(1,2)-beacons(4,1)*beacons(2,3)*beacons(3,2)+beacons(4,1)*beacons(1,3)*beacons(3,2)+beacons(1,1)*beacons(2,3)*beacons(3,2)-beacons(4,1)*beacons(1,2)*beacons(3,3)+beacons(4,2)*beacons(1,1)*beacons(3,3)+beacons(4,2)*beacons(3,1)*beacons(2,3)-beacons(4,2)*beacons(3,1)*beacons(1,3)-beacons(4,2)*beacons(1,1)*beacons(2,3)-beacons(4,1)*beacons(2,2)*beacons(1,3)+beacons(4,1)*beacons(2,2)*beacons(3,3)-beacons(4,3)*beacons(3,2)*beacons(1,1)-beacons(2,1)*beacons(4,3)*beacons(1,2)+beacons(2,1)*beacons(4,2)*beacons(1,3)-beacons(2,1)*beacons(1,3)*beacons(3,2)+beacons(2,1)*beacons(1,2)*beacons(3,3)+beacons(2,1)*beacons(4,3)*beacons(3,2)-beacons(2,1)*beacons(4,2)*beacons(3,3));
if temp == 0
    % problem is underdefined
%     warning('x will be Inf/NaN in min_per_constr, returning zero');
    x = 0; y = 0; z = 0;
    return
end
x=-1/2*(beacons(2,2)*beacons(1,2)^2*beacons(3,3)+beacons(2,2)*beacons(1,3)*beacons(4,3)^2-beacons(2,3)*beacons(4,3)^2*beacons(1,2)+beacons(2,2)*beacons(3,3)^2*beacons(4,3)-beacons(2,2)*dists(3)^2*beacons(4,3)-beacons(2,2)*beacons(1,3)*dists(4)^2-beacons(2,3)*beacons(4,2)*beacons(3,1)^2-beacons(2,3)*beacons(1,2)^2*beacons(3,2)+beacons(2,3)*beacons(4,1)^2*beacons(3,2)-beacons(2,2)*beacons(3,3)*beacons(4,1)^2+beacons(2,2)*beacons(1,3)*beacons(4,1)^2+beacons(2,2)*dists(1)^2*beacons(4,3)+beacons(2,3)*dists(1)^2*beacons(3,2)-beacons(2,3)*dists(4)^2*beacons(3,2)+beacons(2,3)*beacons(4,2)*beacons(1,2)^2-beacons(2,3)*beacons(4,2)^2*beacons(1,2)-beacons(2,3)*beacons(1,2)*dists(3)^2-beacons(2,3)*beacons(1,1)^2*beacons(3,2)-beacons(2,3)*beacons(4,2)*beacons(3,3)^2-beacons(2,3)*beacons(1,3)^2*beacons(3,2)+beacons(2,3)*beacons(1,2)*beacons(3,1)^2+beacons(2,2)*beacons(1,3)^2*beacons(3,3)-beacons(2,2)*beacons(3,3)*beacons(4,3)^2-beacons(2,2)*beacons(1,2)^2*beacons(4,3)+beacons(2,2)*beacons(1,3)*dists(3)^2-beacons(2,2)*beacons(1,3)*beacons(3,2)^2+beacons(2,2)*beacons(3,2)^2*beacons(4,3)+beacons(2,2)*beacons(3,3)*dists(4)^2+beacons(2,2)*beacons(1,3)*beacons(4,2)^2-beacons(2,2)*beacons(3,3)*beacons(4,2)^2-beacons(2,2)*dists(1)^2*beacons(3,3)-beacons(2,2)*beacons(1,3)*beacons(3,3)^2+beacons(1,3)*beacons(4,2)*beacons(3,3)^2+dists(3)^2*beacons(4,3)*beacons(1,2)-beacons(1,3)*beacons(4,3)^2*beacons(3,2)-beacons(1,3)*beacons(4,1)^2*beacons(3,2)-beacons(1,3)*beacons(4,2)^2*beacons(3,2)-beacons(3,3)^2*beacons(4,3)*beacons(1,2)+beacons(1,2)^2*beacons(4,3)*beacons(3,2)+beacons(1,3)*dists(4)^2*beacons(3,2)+beacons(1,3)^2*beacons(4,3)*beacons(3,2)-beacons(2,2)*beacons(1,3)^2*beacons(4,3)+beacons(3,3)*beacons(4,1)^2*beacons(1,2)+beacons(3,3)*beacons(4,2)^2*beacons(1,2)-beacons(3,2)^2*beacons(4,3)*beacons(1,2)+beacons(3,3)*beacons(4,3)^2*beacons(1,2)-dists(1)^2*beacons(4,3)*beacons(3,2)-beacons(3,3)*dists(4)^2*beacons(1,2)+beacons(2,3)*beacons(4,3)^2*beacons(3,2)+beacons(2,3)*beacons(4,2)^2*beacons(3,2)-beacons(2,3)*beacons(4,2)*beacons(3,2)^2+beacons(2,3)*dists(4)^2*beacons(1,2)+beacons(2,3)*beacons(1,2)*beacons(3,2)^2+beacons(2,3)*beacons(4,2)*beacons(1,3)^2-beacons(3,1)^2*beacons(4,3)*beacons(1,2)+beacons(3,1)^2*beacons(4,3)*beacons(2,2)-beacons(3,1)^2*beacons(1,3)*beacons(2,2)+beacons(1,1)^2*beacons(2,2)*beacons(3,3)-beacons(1,1)^2*beacons(4,3)*beacons(2,2)+beacons(1,1)^2*beacons(4,3)*beacons(3,2)+beacons(1,3)*beacons(4,2)*beacons(3,2)^2-beacons(1,3)*beacons(4,2)*dists(3)^2+beacons(2,3)*beacons(4,2)*dists(3)^2+beacons(2,3)*beacons(4,2)*beacons(1,1)^2-beacons(2,3)*beacons(4,1)^2*beacons(1,2)+beacons(2,3)*beacons(1,2)*beacons(3,3)^2-beacons(2,3)*beacons(4,2)*dists(1)^2+beacons(1,3)*beacons(4,2)*beacons(3,1)^2-beacons(1,1)^2*beacons(4,2)*beacons(3,3)+beacons(2,2)^2*beacons(4,3)*beacons(1,2)-beacons(2,2)^2*beacons(4,2)*beacons(1,3)+beacons(2,2)^2*beacons(1,3)*beacons(3,2)-beacons(2,2)^2*beacons(1,2)*beacons(3,3)-beacons(2,2)^2*beacons(4,3)*beacons(3,2)+beacons(2,2)^2*beacons(4,2)*beacons(3,3)-beacons(1,2)^2*beacons(4,2)*beacons(3,3)-beacons(1,3)^2*beacons(4,2)*beacons(3,3)-dists(2)^2*beacons(4,3)*beacons(1,2)+dists(2)^2*beacons(4,2)*beacons(1,3)-dists(2)^2*beacons(1,3)*beacons(3,2)+dists(2)^2*beacons(1,2)*beacons(3,3)+dists(2)^2*beacons(4,3)*beacons(3,2)-dists(2)^2*beacons(4,2)*beacons(3,3)+dists(1)^2*beacons(4,2)*beacons(3,3)+beacons(2,3)^2*beacons(4,3)*beacons(1,2)-beacons(2,3)^2*beacons(4,2)*beacons(1,3)+beacons(2,3)^2*beacons(1,3)*beacons(3,2)-beacons(2,3)^2*beacons(1,2)*beacons(3,3)-beacons(2,3)^2*beacons(4,3)*beacons(3,2)+beacons(2,3)^2*beacons(4,2)*beacons(3,3)-beacons(2,1)^2*beacons(1,2)*beacons(3,3)+beacons(2,1)^2*beacons(4,2)*beacons(3,3)+beacons(2,1)^2*beacons(4,3)*beacons(1,2)+beacons(2,1)^2*beacons(1,3)*beacons(3,2)-beacons(2,1)^2*beacons(4,2)*beacons(1,3)-beacons(2,1)^2*beacons(4,3)*beacons(3,2))/temp;
if isnan(x)
    error('x is NaN in min_per_constr');
end
if isinf(x)
    error('x is Inf in min_per_constr');
end
y=-1/2*(dists(1)^2*beacons(4,1)*beacons(2,3)+beacons(2,1)*dists(3)^2*beacons(4,3)+beacons(1,1)^2*beacons(4,1)*beacons(3,3)+beacons(1,2)^2*beacons(3,1)*beacons(2,3)+beacons(2,1)*beacons(1,3)*beacons(3,3)^2+beacons(3,3)*beacons(4,1)*dists(2)^2+beacons(2,1)*dists(1)^2*beacons(3,3)+beacons(1,3)*beacons(4,1)*dists(3)^2+beacons(1,3)*beacons(4,1)*beacons(2,2)^2-beacons(2,1)^2*beacons(4,1)*beacons(3,3)-beacons(1,1)*beacons(2,3)*beacons(3,2)^2+beacons(2,1)*beacons(3,3)*beacons(4,2)^2+beacons(2,1)^2*beacons(3,3)*beacons(1,1)+beacons(1,3)*beacons(3,1)*dists(2)^2-beacons(2,1)*beacons(1,3)*beacons(4,2)^2-beacons(1,1)^2*beacons(4,1)*beacons(2,3)+beacons(2,1)*beacons(1,3)*dists(4)^2-beacons(3,1)*beacons(2,3)*beacons(4,1)^2-beacons(3,1)*beacons(2,3)*beacons(4,2)^2+beacons(3,3)^2*beacons(1,1)*beacons(4,3)+beacons(1,1)*beacons(2,3)*beacons(4,3)^2-beacons(1,1)*beacons(2,3)^2*beacons(4,3)+beacons(1,3)^2*beacons(4,1)*beacons(3,3)+beacons(3,1)*beacons(1,3)*beacons(4,3)^2-beacons(2,1)*beacons(3,3)*dists(4)^2-dists(3)^2*beacons(4,1)*beacons(2,3)+beacons(1,1)*beacons(2,3)*beacons(4,1)^2-beacons(2,1)*beacons(3,2)^2*beacons(4,3)-dists(3)^2*beacons(1,1)*beacons(4,3)+beacons(2,1)*beacons(1,3)*beacons(3,2)^2-beacons(3,1)*beacons(1,3)^2*beacons(4,3)+beacons(3,1)*beacons(2,2)^2*beacons(4,3)-beacons(3,1)*beacons(2,3)*beacons(4,3)^2-beacons(1,3)^2*beacons(4,1)*beacons(2,3)-beacons(1,3)*beacons(4,1)*dists(2)^2-beacons(3,3)*beacons(1,1)*beacons(4,3)^2+beacons(2,1)*beacons(1,3)^2*beacons(4,3)-beacons(2,1)*beacons(1,1)^2*beacons(3,3)-beacons(2,1)*beacons(1,3)*dists(3)^2+beacons(3,1)*beacons(2,3)*dists(4)^2-beacons(3,3)*beacons(4,1)*beacons(2,2)^2+beacons(3,1)*dists(1)^2*beacons(4,3)+beacons(2,1)*beacons(1,2)^2*beacons(4,3)-beacons(3,3)*beacons(1,1)*beacons(4,2)^2-beacons(1,1)*beacons(2,3)*beacons(3,3)^2+beacons(3,1)^2*beacons(4,1)*beacons(2,3)+beacons(3,1)*beacons(1,3)*beacons(4,1)^2-beacons(1,3)*beacons(4,1)*beacons(3,3)^2-beacons(1,3)*beacons(3,1)*beacons(2,2)^2+beacons(3,2)^2*beacons(1,1)*beacons(4,3)+beacons(1,1)*beacons(2,2)^2*beacons(3,3)-beacons(3,1)*dists(2)^2*beacons(4,3)+beacons(2,1)^2*beacons(4,1)*beacons(1,3)-beacons(1,1)*beacons(2,3)*beacons(3,1)^2-beacons(1,3)*beacons(4,1)*beacons(3,2)^2-beacons(3,3)*beacons(4,1)*beacons(2,3)^2-beacons(1,2)^2*beacons(4,1)*beacons(2,3)+beacons(1,3)^2*beacons(3,1)*beacons(2,3)+beacons(2,1)^2*beacons(4,3)*beacons(3,1)-beacons(2,1)*beacons(3,3)^2*beacons(4,3)-dists(1)^2*beacons(3,1)*beacons(2,3)-beacons(3,3)*beacons(1,1)*beacons(4,1)^2-dists(1)^2*beacons(4,1)*beacons(3,3)+beacons(3,3)^2*beacons(4,1)*beacons(2,3)+beacons(2,1)*beacons(3,3)*beacons(4,3)^2-beacons(1,3)*beacons(4,1)*beacons(3,1)^2+beacons(1,1)^2*beacons(3,1)*beacons(2,3)+beacons(1,1)*beacons(2,3)^2*beacons(3,3)+beacons(3,2)^2*beacons(4,1)*beacons(2,3)-beacons(2,1)^2*beacons(4,3)*beacons(1,1)-beacons(2,1)*beacons(3,1)^2*beacons(4,3)-beacons(1,1)*dists(2)^2*beacons(3,3)-beacons(3,1)*beacons(1,1)^2*beacons(4,3)+beacons(1,3)*beacons(4,1)*beacons(2,3)^2-beacons(3,1)*beacons(1,3)*dists(4)^2-beacons(2,1)*beacons(1,3)^2*beacons(3,3)+beacons(1,1)*dists(2)^2*beacons(4,3)-beacons(2,1)*dists(1)^2*beacons(4,3)-beacons(2,1)^2*beacons(3,1)*beacons(1,3)+beacons(2,1)*beacons(1,1)^2*beacons(4,3)+beacons(1,1)*beacons(2,3)*dists(3)^2-beacons(2,1)*beacons(1,3)*beacons(4,1)^2+beacons(2,1)*beacons(3,3)*beacons(4,1)^2-beacons(1,1)*beacons(2,3)*dists(4)^2-beacons(1,1)*beacons(2,2)^2*beacons(4,3)+beacons(1,1)*beacons(2,3)*beacons(4,2)^2+beacons(2,1)*beacons(3,1)^2*beacons(1,3)+beacons(3,1)^2*beacons(1,1)*beacons(4,3)-beacons(1,3)*beacons(3,1)*beacons(2,3)^2+beacons(3,3)*beacons(1,1)*dists(4)^2+beacons(3,1)*beacons(1,3)*beacons(4,2)^2+beacons(3,1)*beacons(2,3)^2*beacons(4,3)-beacons(2,1)*beacons(1,3)*beacons(4,3)^2-beacons(2,1)*beacons(1,2)^2*beacons(3,3)+beacons(1,2)^2*beacons(4,1)*beacons(3,3)-beacons(1,2)^2*beacons(4,3)*beacons(3,1))/temp;
z=1/2*(beacons(4,2)*beacons(3,1)*dists(1)^2+beacons(2,1)^2*beacons(4,1)*beacons(1,2)-beacons(4,2)*beacons(3,1)*beacons(1,2)^2+dists(4)^2*beacons(3,1)*beacons(2,2)-beacons(4,1)*dists(2)^2*beacons(1,2)+beacons(1,1)*beacons(2,2)*dists(3)^2+beacons(2,1)*beacons(4,1)^2*beacons(3,2)+beacons(4,1)*beacons(1,2)*dists(3)^2-beacons(1,1)*dists(2)^2*beacons(3,2)-beacons(2,1)*beacons(1,2)^2*beacons(3,2)-dists(1)^2*beacons(3,1)*beacons(2,2)+beacons(4,1)*beacons(2,2)*beacons(3,2)^2+beacons(1,1)^2*beacons(3,1)*beacons(2,2)-beacons(2,1)*beacons(4,2)*beacons(3,1)^2+beacons(4,1)*beacons(2,2)*beacons(3,3)^2+beacons(2,1)^2*beacons(4,2)*beacons(3,1)-beacons(2,1)*beacons(4,3)^2*beacons(1,2)-beacons(4,2)*beacons(1,1)*beacons(2,2)^2-beacons(4,3)^2*beacons(3,1)*beacons(2,2)+beacons(2,1)*beacons(1,2)*beacons(3,1)^2-beacons(4,1)^2*beacons(3,2)*beacons(1,1)-beacons(4,1)*beacons(2,2)^2*beacons(3,2)-beacons(2,1)*beacons(1,3)^2*beacons(3,2)-beacons(2,1)*beacons(4,2)*beacons(3,3)^2+beacons(4,1)^2*beacons(1,1)*beacons(2,2)-beacons(2,1)*beacons(1,1)^2*beacons(3,2)-beacons(1,1)*beacons(2,2)*beacons(3,1)^2-beacons(1,2)*beacons(3,1)*beacons(2,3)^2-beacons(2,1)^2*beacons(4,2)*beacons(1,1)+beacons(4,1)*beacons(2,2)*beacons(3,1)^2-beacons(2,1)*beacons(1,2)*dists(3)^2+beacons(1,2)*beacons(3,1)*dists(2)^2-beacons(2,1)*beacons(4,2)^2*beacons(1,2)-beacons(4,3)^2*beacons(3,2)*beacons(1,1)-beacons(4,1)*dists(1)^2*beacons(3,2)+beacons(4,2)*beacons(1,1)*beacons(3,2)^2+beacons(1,1)*beacons(2,3)^2*beacons(3,2)-beacons(4,2)*beacons(1,1)*beacons(2,3)^2+beacons(4,1)*beacons(1,1)^2*beacons(3,2)+beacons(1,3)^2*beacons(3,1)*beacons(2,2)+beacons(2,1)*beacons(4,2)*beacons(1,2)^2-beacons(2,1)*dists(4)^2*beacons(3,2)-beacons(4,2)*beacons(3,1)*dists(2)^2-beacons(4,1)*beacons(1,2)*beacons(3,3)^2-beacons(4,2)*beacons(1,1)*dists(3)^2-beacons(4,2)*beacons(3,1)*beacons(1,1)^2+beacons(4,2)*beacons(1,1)*beacons(3,1)^2+beacons(4,2)*beacons(3,1)*beacons(2,2)^2-beacons(4,1)*beacons(2,3)^2*beacons(3,2)+beacons(4,3)^2*beacons(3,1)*beacons(1,2)+beacons(2,1)*dists(1)^2*beacons(3,2)-beacons(1,1)*beacons(2,2)*beacons(3,2)^2-beacons(4,1)*beacons(2,2)*beacons(1,3)^2+beacons(4,1)*beacons(2,2)*dists(1)^2+beacons(2,1)*beacons(4,3)^2*beacons(3,2)+beacons(2,1)*beacons(4,2)^2*beacons(3,2)-beacons(4,2)*beacons(3,1)*beacons(1,3)^2-beacons(2,1)*beacons(4,2)*beacons(3,2)^2+beacons(4,2)*beacons(3,1)*beacons(2,3)^2+beacons(4,1)*beacons(2,2)^2*beacons(1,2)-beacons(4,1)*beacons(1,2)*beacons(3,1)^2-beacons(1,1)*beacons(2,2)*beacons(3,3)^2+beacons(4,2)*beacons(1,1)*beacons(3,3)^2-beacons(2,1)^2*beacons(4,1)*beacons(3,2)+beacons(2,1)*dists(4)^2*beacons(1,2)+beacons(1,2)^2*beacons(3,1)*beacons(2,2)+beacons(2,1)*beacons(1,2)*beacons(3,2)^2+beacons(4,2)^2*beacons(1,1)*beacons(2,2)+beacons(2,1)*beacons(4,2)*beacons(1,3)^2+beacons(4,3)^2*beacons(1,1)*beacons(2,2)+beacons(4,2)*beacons(1,1)*dists(2)^2-beacons(4,1)*beacons(2,2)*beacons(1,1)^2-dists(4)^2*beacons(1,1)*beacons(2,2)+beacons(4,1)*beacons(1,2)^2*beacons(3,2)+dists(4)^2*beacons(3,2)*beacons(1,1)+beacons(4,2)^2*beacons(3,1)*beacons(1,2)-beacons(4,1)*beacons(2,2)*dists(3)^2+beacons(2,1)*beacons(4,2)*dists(3)^2+beacons(2,1)*beacons(4,2)*beacons(1,1)^2-dists(4)^2*beacons(3,1)*beacons(1,2)-beacons(4,1)^2*beacons(3,1)*beacons(2,2)+beacons(2,1)^2*beacons(3,2)*beacons(1,1)+beacons(4,1)*dists(2)^2*beacons(3,2)+beacons(1,1)*beacons(2,2)^2*beacons(3,2)-beacons(4,2)^2*beacons(3,2)*beacons(1,1)-beacons(2,1)*beacons(4,1)^2*beacons(1,2)-beacons(1,2)*beacons(3,1)*beacons(2,2)^2+beacons(2,1)*beacons(1,2)*beacons(3,3)^2+beacons(4,1)*beacons(2,3)^2*beacons(1,2)-beacons(2,1)*beacons(4,2)*dists(1)^2-beacons(4,1)*beacons(2,2)*beacons(1,2)^2+beacons(4,1)*beacons(1,3)^2*beacons(3,2)-beacons(4,1)*beacons(1,2)*beacons(3,2)^2+beacons(4,1)^2*beacons(3,1)*beacons(1,2)-beacons(4,2)^2*beacons(3,1)*beacons(2,2)-beacons(2,1)^2*beacons(3,1)*beacons(1,2))/temp;
